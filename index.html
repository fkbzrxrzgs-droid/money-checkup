<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æˆ‘çš„è²¡å¯Œäººæ ¼æ¸¬é©—</title>
    
    <!-- å¼•å…¥ html2canvas (ç”¨æ–¼æˆªåœ–åŠŸèƒ½) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <!-- å¼•å…¥å­—é«” -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Roboto:wght@700;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #006e7f;
            --secondary: #f59e0b;
            --bg: #f4f7f6;
            --text: #2c3e50;
            --card-bg: #ffffff;
        }
        
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        
        body { 
            background-color: var(--bg); 
            font-family: 'Noto Sans TC', sans-serif; 
            color: var(--text); 
            padding-bottom: 60px; 
            overflow-x: hidden;
        }
        
        .container { max-width: 800px; margin: 0 auto; padding: 20px; }
        
        /* Header (å¿ƒç†æ¸¬é©—é¢¨) */
        header { 
            text-align: center; 
            margin-bottom: 25px; 
            padding: 30px 20px; 
            background: linear-gradient(135deg, #006e7f 0%, #004d59 100%);
            border-radius: 15px;
            color: white;
            box-shadow: 0 10px 25px rgba(0,110,127,0.2);
            position: relative;
            overflow: hidden;
        }
        
        /* è£é£¾èƒŒæ™¯åœ“ */
        header::before {
            content: '';
            position: absolute;
            top: -50%; left: -50%;
            width: 200%; height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 60%);
            animation: rotate 20s linear infinite;
        }
        
        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        .header-icon { font-size: 40px; display: block; margin-bottom: 10px; position: relative; z-index: 1; }
        
        h1 { 
            color: white; 
            font-size: 26px; 
            font-weight: 900; 
            margin-bottom: 8px; 
            letter-spacing: 1px; 
            text-shadow: 0 2px 4px rgba(0,0,0,0.2); 
            position: relative; z-index: 1;
        }
        
        p.subtitle { 
            color: rgba(255,255,255,0.9); 
            font-size: 14px; 
            line-height: 1.5; 
            font-weight: 400; 
            position: relative; z-index: 1;
        }

        /* Form */
        .form-section { 
            background: var(--card-bg); 
            padding: 20px; 
            border-radius: 12px; 
            margin-bottom: 20px; 
            display: flex; 
            flex-wrap: wrap; 
            gap: 15px; 
            border: 1px solid #e2e8f0; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.02);
        }
        
        .input-group { flex: 1 1 100%; }
        
        @media (min-width: 600px) {
             .input-group { flex: 1 1 30%; }
        }

        label { 
            display: block; 
            font-size: 13px; 
            color: var(--primary); 
            font-weight: 700; 
            margin-bottom: 5px; 
        }
        
        input[type="text"], input[type="tel"] { 
            width: 100%; 
            padding: 12px; 
            border: 1px solid #cbd5e1; 
            border-radius: 8px; 
            font-size: 16px; 
            background: #fcfcfc; 
            outline: none; 
            transition: border 0.3s;
        }
        
        input:focus { border-color: var(--primary); background: #fff; }
        
        /* éŒ¯èª¤ç‹€æ…‹æ¨£å¼ */
        .input-error { border-color: #e11d48 !important; background-color: #fff5f5 !important; }
        .card-error { border-color: #e11d48 !important; box-shadow: 0 0 10px rgba(225, 29, 72, 0.2) !important; }


        /* Quiz Grid */
        .quiz-grid { 
            display: grid; 
            gap: 15px; 
            grid-template-columns: 1fr; /* æ‰‹æ©Ÿå–®æ¬„ */
        }
        
        @media (min-width: 600px) {
            .quiz-grid { grid-template-columns: repeat(2, 1fr); } /* å¹³æ¿é›™æ¬„ */
            .full-width { grid-column: span 2; }
        }
        
        /* Card */
        .question-card { 
            background: var(--card-bg); 
            border-radius: 12px; 
            padding: 15px 20px; 
            border: 1px solid #e2e8f0; 
            border-left-width: 5px;
            border-left-style: solid;
            transition: transform 0.2s; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.02);
        }
        
        .mod-1 { border-left-color: #334155; } .mod-1 .q-num { color: #334155; }
        .mod-2 { border-left-color: #f59e0b; } .mod-2 .q-num { color: #f59e0b; }
        .mod-3 { border-left-color: #059669; } .mod-3 .q-num { color: #059669; }
        .mod-4 { border-left-color: #be123c; } .mod-4 .q-num { color: #be123c; }
        .mod-pain { border-left-color: #ef4444; background-color: #fffbfb; } .mod-pain .q-num { color: #ef4444; }

        .q-header { display: flex; align-items: flex-start; margin-bottom: 10px; }
        .q-num { 
            font-family: 'Roboto', sans-serif; 
            font-size: 22px; 
            font-weight: 900; 
            margin-right: 10px; 
            opacity: 0.9;
            min-width: 30px;
        }
        
        .q-title { font-size: 16px; font-weight: 700; line-height: 1.3; }
        
        /* è¤‡é¸æç¤ºæ¨£å¼ */
        .q-multi-hint { 
            font-size: 12px; 
            color: #64748b; 
            background: #f1f5f9; 
            padding: 2px 6px; 
            border-radius: 4px; 
            margin-left: 6px; 
            white-space: nowrap;
            font-weight: 400;
            vertical-align: middle;
            display: inline-block;
        }
        
        .options { display: flex; flex-direction: column; gap: 8px; }
        
        .option-label { 
            display: flex; 
            align-items: center; 
            padding: 12px; 
            border: 1px solid #e2e8f0; 
            border-radius: 8px; 
            background: white; 
            transition: 0.2s; 
            min-height: 48px; /* åŠ å¤§è§¸æ§å€ */
            cursor: pointer; 
            -webkit-user-select: none;
            user-select: none;
        }
        
        .option-label:active { transform: scale(0.98); background-color: #f8fafc; }
        
        .option-label.selected { 
            background-color: #f0f9fa; 
            border-color: var(--primary); 
            box-shadow: 0 0 0 1px var(--primary) inset;
        }
        
        .option-label.selected .option-text { color: var(--primary); font-weight: 700; }
        
        .box { 
            width: 20px; height: 20px; 
            border: 2px solid #cbd5e1; 
            border-radius: 5px; 
            margin-right: 12px; 
            display: flex; align-items: center; justify-content: center; 
            flex-shrink: 0;
            background: #fff;
        }
        
        .option-label.selected .box { background: var(--primary); border-color: var(--primary); }
        
        .box::after { 
            content: 'âœ“'; 
            color: white; 
            font-size: 14px; 
            display: none; 
            font-weight: 900;
        }
        
        .option-label.selected .box::after { display: block; }
        
        .option-text { font-size: 15px; color: #475569; flex: 1; }
        
        input[type="checkbox"] { display: none; }

        /* Q5 è¼¸å…¥æ¡† */
        .inline-input { 
            border: none; 
            border-bottom: 1px dashed #94a3b8; 
            background: transparent; 
            font-size: 15px; 
            color: #333; 
            width: 100px; 
            margin-left: 8px; 
            padding: 2px; 
            outline: none; 
        }
        .inline-input:focus { border-bottom: 2px solid var(--primary); }

        /* Button */
        .actions { margin-top: 40px; text-align: center; padding: 0 20px; }
        .btn { 
            background: linear-gradient(to right, #006e7f, #004d59); 
            color: white; 
            border: none; 
            padding: 16px 30px; 
            font-size: 18px; 
            font-weight: 700; 
            border-radius: 50px; 
            width: 100%; 
            max-width: 350px; 
            box-shadow: 0 6px 15px rgba(0,110,127,0.3); 
            cursor: pointer; 
            transition: transform 0.2s; 
        }
        .btn:active { transform: scale(0.95); }

        /* --- Analysis Overlay (åˆ†æçµæœé ) --- */
        #analysis-overlay { 
            display: none; 
            position: fixed; 
            top: 0; left: 0; 
            width: 100%; height: 100%; 
            background: rgba(0,0,0,0.9); 
            z-index: 9999; 
            overflow-y: auto; 
            padding: 10px; 
            -webkit-overflow-scrolling: touch;
        }
        
        .analysis-card { 
            background: white; 
            width: 100%;
            max-width: 500px; 
            margin: 20px auto; 
            border-radius: 15px; 
            overflow: hidden; 
            position: relative; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        
        .persona-header { 
            background: var(--primary); 
            color: white; 
            padding: 30px 20px; 
            text-align: center; 
            position: relative;
            transition: background 0.5s ease;
        }
        
        .persona-img-container { 
            width: 100px; height: 100px; 
            margin: 0 auto 15px auto; 
            border-radius: 50%; 
            border: 4px solid white; 
            background: #fff;
            overflow: hidden;
            display: flex; justify-content: center; align-items: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .persona-img { width: 100%; height: 100%; object-fit: cover; }
        .persona-emoji { font-size: 50px; line-height: 100px; }

        .persona-title { font-size: 24px; font-weight: 900; margin-bottom: 5px; letter-spacing: 1px; }
        
        .persona-code { 
            display: inline-block; 
            background: rgba(255,255,255,0.2); 
            padding: 4px 15px; 
            border-radius: 20px; 
            font-family: 'Roboto', sans-serif; 
            letter-spacing: 2px; 
            font-size: 16px; 
            font-weight: 700;
            margin-top: 5px;
            border: 1px solid rgba(255,255,255,0.3);
            backdrop-filter: blur(4px);
        }
        
        .persona-body { padding: 25px 20px; }
        
        /* Progress Bars */
        .trait-row { display: flex; align-items: center; margin-bottom: 12px; font-size: 13px; color: #555; }
        .trait-label { width: 40px; text-align: center; font-weight: 700; color: #333; }
        .trait-bar-bg { flex: 1; height: 8px; background: #eee; border-radius: 4px; margin: 0 10px; position: relative; overflow: hidden;}
        .trait-bar-fill { height: 100%; border-radius: 4px; position: absolute; top: 0; transition: width 1s ease; }
        
        .bar-left { left: 0; background: #94a3b8; }
        .bar-right { right: 0; background: var(--secondary); }
        .color-growth { background: var(--secondary); }
        .color-safe { background: #006e7f; }

        .analysis-text { 
            background: #f8fafc; 
            padding: 15px; 
            border-radius: 8px; 
            font-size: 14px; 
            line-height: 1.6; 
            color: #333; 
            margin-top: 20px; 
            border-left: 4px solid var(--secondary);
            text-align: left;
        }

        .cta-box { margin-top: 25px; text-align: center; border-top: 1px dashed #ddd; padding-top: 20px; }
        .cta-text { font-size: 15px; color: #333; margin-bottom: 12px; line-height: 1.5; font-weight: 700;}
        .cta-sub { font-size: 12px; color: #666; font-weight: 400; display: block; margin-top: 2px;}
        .cta-highlight { color: #e11d48; font-weight: 700; background: #fff1f2; padding: 2px 5px; border-radius: 4px;}

        .next-step-btn { 
            background: #e11d48; 
            color: white; 
            padding: 14px 25px; 
            border-radius: 50px; 
            text-decoration: none; 
            font-weight: 700; 
            display: inline-block; 
            box-shadow: 0 4px 10px rgba(225, 29, 72, 0.3); 
            animation: pulse 2s infinite; 
            border: none; 
            cursor: pointer; 
            font-size: 16px; 
            width: 100%; 
        }
        
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.02); } 100% { transform: scale(1); } }

        /* Hidden Capture Area (æˆªåœ–å°ˆç”¨å€ï¼Œä¸æœƒé¡¯ç¤ºåœ¨ç¶²é ä¸Š) */
        #capture-area { 
            position: fixed; left: -9999px; top: 0; 
            width: 600px; /* å›ºå®šå¯¬åº¦ç¢ºä¿æ‰‹æ©Ÿæˆªåœ–æ¸…æ™° */
            background: white; 
            padding: 40px; 
            font-family: 'Noto Sans TC', sans-serif; 
            box-sizing: border-box;
        }

        .cap-header {
            text-align: center;
            border-bottom: 2px solid var(--primary);
            padding-bottom: 20px;
            margin-bottom: 30px;
        }

        .cap-info {
            background: #f8fafc;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            font-size: 16px;
            border: 1px solid #e2e8f0;
        }

        .cap-item {
            margin-bottom: 12px;
            border-bottom: 1px dashed #eee;
            padding-bottom: 5px;
        }
        .cap-q { color: var(--primary); font-weight: 700; font-size: 14px; margin-bottom: 4px; }
        .cap-a { color: #333; font-size: 15px; font-weight: 500; }
        
        /* æˆªåœ–å€çš„ä»£ç¢¼é¡¯ç¤º */
        .cap-code-box {
            text-align: right; border-left: 2px solid #ccc; padding-left: 15px; min-width: 150px;
        }

        /* Result Image Overlay */
        #result-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 10000; overflow-y: auto; padding: 20px; text-align: center; }
        #final-image-container { max-width: 500px; margin: 20px auto; }
        #generated-image { width: 100%; height: auto; border-radius: 10px; display: block; box-shadow: 0 5px 20px rgba(0,0,0,0.5); }
        .close-btn { margin-top: 20px; padding: 10px 30px; border-radius: 20px; border: 1px solid white; background: transparent; color: white; cursor: pointer; font-size: 14px; }

    </style>
</head>
<body>

<div class="container">
    <header>
        <span class="header-icon">ğŸ”®</span>
        <h1>æˆ‘çš„è²¡å¯Œäººæ ¼æ¸¬é©—</h1>
        <p class="subtitle">30ç§’æ¸¬å‡ºæ‚¨çš„éš±è—ç†è²¡åŸºå› ï¼Œè§£é–å°ˆå±¬è‡´å¯Œå¯†ç¢¼ã€‚</p>
    </header>

    <!-- å¡«å¯«å€‹è³‡å€ -->
    <div class="form-section">
        <div class="input-group">
            <label>æ‚¨çš„å§“å / ç¨±å‘¼ <span style="color:#e11d48">*</span></label>
            <input type="text" id="name" placeholder="è«‹è¼¸å…¥å§“å">
        </div>
        <div class="input-group">
            <label>è¯çµ¡é›»è©±</label>
            <input type="tel" id="phone" placeholder="09xx-xxx-xxx">
        </div>
        <div class="input-group">
            <label>LINE ID (æ–¹ä¾¿å‚³é€å ±å‘Š)</label>
            <input type="text" id="lineId" placeholder="è«‹è¼¸å…¥ ID">
        </div>
    </div>

    <form id="quizForm">
        <div class="quiz-grid">
            <!-- Q1 (å¯è¤‡é¸) -->
            <div class="question-card mod-1" id="card-Q1">
                <div class="q-header"><span class="q-num">01</span><div class="q-title">æŠ•è³‡ä¸»è¦å‹•æ©Ÿ<span class="q-multi-hint">(å¯è¤‡é¸)</span></div></div>
                <div class="options" data-id="Q1">
                    <label class="option-label"><input type="checkbox" value="æˆé•·" data-score="growth:2;driver:O"><div class="box"></div><span class="option-text">è³‡ç”¢é•·æœŸæˆé•·</span></label>
                    <label class="option-label"><input type="checkbox" value="ç¾é‡‘æµ" data-score="defend:2;driver:F"><div class="box"></div><span class="option-text">å‰µé€ ç©©å®šç¾é‡‘æµ</span></label>
                    <label class="option-label"><input type="checkbox" value="æŠ—é€šè†¨" data-score="growth:1"><div class="box"></div><span class="option-text">æŠ—é€šè†¨</span></label>
                    <label class="option-label"><input type="checkbox" value="ç‰¹å®šç›®æ¨™" data-score="defend:1;driver:G"><div class="box"></div><span class="option-text">ç‰¹å®šç›®æ¨™ (è²·æˆ¿/é€€ä¼‘)</span></label>
                </div>
            </div>

            <!-- Q2 -->
            <div class="question-card mod-1" id="card-Q2">
                <div class="q-header"><span class="q-num">02</span><div><div class="q-title">è³‡é‡‘é–‰é–æœŸ</div><span class="q-desc">å¤šä¹…å…§ä¸éœ€å‹•ç”¨ï¼Ÿ</span></div></div>
                <div class="options" data-id="Q2">
                    <label class="option-label"><input type="checkbox" value="1å¹´å…§" data-score="short:2"><div class="box"></div><span class="option-text">1 å¹´å…§ (éœ€éš¨æ™‚å‹•ç”¨)</span></label>
                    <label class="option-label"><input type="checkbox" value="1-3å¹´" data-score="short:1"><div class="box"></div><span class="option-text">1 - 3 å¹´ (çŸ­æœŸé–’ç½®)</span></label>
                    <label class="option-label"><input type="checkbox" value="3-5å¹´" data-score="long:1"><div class="box"></div><span class="option-text">3 - 5 å¹´ (ç©©å¥è¦åŠƒ)</span></label>
                    <label class="option-label"><input type="checkbox" value="5å¹´ä»¥ä¸Š" data-score="long:2;driver:G"><div class="box"></div><span class="option-text">5 - 10 å¹´ä»¥ä¸Š (é•·æœŸä¸å‹•)</span></label>
                </div>
            </div>

            <!-- Q3 -->
            <div class="question-card mod-3" id="card-Q3">
                <div class="q-header"><span class="q-num">03</span><div class="q-title">é¢¨éšªç›´è¦º (ä¸‹è·Œ)</div></div>
                <div class="options" data-id="Q3">
                    <label class="option-label"><input type="checkbox" value="-5%" data-score="feeling:2;driver:A"><div class="box"></div><span class="option-text">-5% æœƒå¾ˆä¸å®‰</span></label>
                    <label class="option-label"><input type="checkbox" value="-10%" data-score="feeling:1"><div class="box"></div><span class="option-text">-10% é‚„èƒ½è§€å¯Ÿ</span></label>
                    <label class="option-label"><input type="checkbox" value="-20%" data-score="logic:1;driver:O"><div class="box"></div><span class="option-text">-20% å¯ä»¥æ¥å—</span></label>
                    <label class="option-label"><input type="checkbox" value="-30%" data-score="logic:2;driver:O"><div class="box"></div><span class="option-text">-30% ä¹Ÿèƒ½å†·éœ</span></label>
                </div>
            </div>

            <!-- Q4 (è³‡é‡‘) -->
            <div class="question-card mod-2" id="card-Q4">
                <div class="q-header"><span class="q-num">04</span><div class="q-title">è³‡é‡‘æ°´ä½</div></div>
                <div class="options" data-id="Q4">
                    <label class="option-label"><input type="checkbox" value="50è¬ä¸‹" data-score="depend:1"><div class="box"></div><span class="option-text">50 è¬ä»¥ä¸‹</span></label>
                    <label class="option-label"><input type="checkbox" value="50-200è¬"><div class="box"></div><span class="option-text">50 - 200 è¬</span></label>
                    <label class="option-label"><input type="checkbox" value="200-500è¬"><div class="box"></div><span class="option-text">200 - 500 è¬</span></label>
                    <label class="option-label"><input type="checkbox" value="500è¬ä¸Š" data-score="indep:2"><div class="box"></div><span class="option-text">500 è¬ä»¥ä¸Š</span></label>
                </div>
            </div>

            <!-- Q5 (åœæ³Š) - å¯è¤‡é¸ -->
            <div class="question-card mod-2" id="card-Q5">
                <div class="q-header"><span class="q-num">05</span><div class="q-title">è³‡é‡‘åœæ³Š<span class="q-multi-hint">(å¯è¤‡é¸)</span></div></div>
                <div class="options" data-id="Q5">
                    <label class="option-label"><input type="checkbox" value="éŠ€è¡Œ" data-score="defend:2"><div class="box"></div><span class="option-text">éŠ€è¡Œ (å®šå­˜/æ´»å­˜)</span></label>
                    <label class="option-label"><input type="checkbox" value="è‚¡å¸‚" data-score="growth:2"><div class="box"></div><span class="option-text">è‚¡å¸‚/ETF</span></label>
                    <label class="option-label"><input type="checkbox" value="ä¿å–®" data-score="defend:1"><div class="box"></div><span class="option-text">å„²è“„éšª/ä¿å–®</span></label>
                    <label class="option-label"><input type="checkbox" value="other" id="q5-other-check"><div class="box"></div><span class="option-text">å…¶ä»–ï¼š<input type="text" id="q5-other-input" class="inline-input" placeholder="è«‹èªªæ˜"></span></label>
                </div>
            </div>

            <!-- Q6 (é…æ¯) -->
            <div class="question-card mod-3" id="card-Q6">
                <div class="q-header"><span class="q-num">06</span><div class="q-title">é…æ¯åå¥½</div></div>
                <div class="options" data-id="Q6">
                    <label class="option-label"><input type="checkbox" value="å–œæ­¡" data-score="depend:2;driver:F"><div class="box"></div><span class="option-text">éå¸¸å–œæ­¡ (è½è¢‹ç‚ºå®‰)</span></label>
                    <label class="option-label"><input type="checkbox" value="å¹³è¡¡"><div class="box"></div><span class="option-text">éƒ¨åˆ†é…ç½® (å¹³è¡¡é¢¨éšª)</span></label>
                    <label class="option-label"><input type="checkbox" value="ä¸éœ€" data-score="indep:2"><div class="box"></div><span class="option-text">ä¸éœ€è¦ (è¿½æ±‚è¤‡åˆ©)</span></label>
                    <label class="option-label"><input type="checkbox" value="ä¸æ‡‚"><div class="box"></div><span class="option-text">ä¸å¤ªäº†è§£å·®ç•°</span></label>
                </div>
            </div>

            <!-- Q7 -->
            <div class="question-card mod-3" id="card-Q7">
                <div class="q-header"><span class="q-num">07</span><div class="q-title">å®¶åº­è²¬ä»»</div></div>
                <div class="options" data-id="Q7">
                    <label class="option-label"><input type="checkbox" value="å–®èº«" data-score="indep:1"><div class="box"></div><span class="option-text">å–®èº«ï¼Œè²¬ä»»ä½</span></label>
                    <label class="option-label"><input type="checkbox" value="å®¶åº­" data-score="depend:1"><div class="box"></div><span class="option-text">æœ‰å®¶åº­ï¼Œè² æ“”å¯æ§</span></label>
                    <label class="option-label"><input type="checkbox" value="é‡æ“”" data-score="depend:2"><div class="box"></div><span class="option-text">æœ‰æˆ¿è²¸/å°å­©/é–‹éŠ·å¤§</span></label>
                    <label class="option-label"><input type="checkbox" value="ä¸ç©©"><div class="box"></div><span class="option-text">æ”¶å…¥ä¸ç©©ï¼Œéœ€ä¿å®ˆ</span></label>
                </div>
            </div>

            <!-- Q8 -->
            <div class="question-card mod-3" id="card-Q8">
                <div class="q-header"><span class="q-num">08</span><div class="q-title">æ³¢å‹•å½±éŸ¿</div></div>
                <div class="options" data-id="Q8">
                    <label class="option-label"><input type="checkbox" value="å¾ˆå¤§" data-score="feeling:2"><div class="box"></div><span class="option-text">æœƒï¼Œå£“åŠ›å¾ˆå¤§</span></label>
                    <label class="option-label"><input type="checkbox" value="æœ‰å½±éŸ¿" data-score="feeling:1"><div class="box"></div><span class="option-text">æœ‰å½±éŸ¿ï¼Œé‚„æ’å¾—ä½</span></label>
                    <label class="option-label"><input type="checkbox" value="æ²’å·®" data-score="logic:1"><div class="box"></div><span class="option-text">å¹¾ä¹æ²’å½±éŸ¿</span></label>
                    <label class="option-label"><input type="checkbox" value="é–’éŒ¢" data-score="logic:2"><div class="box"></div><span class="option-text">å®Œå…¨ç„¡å½±éŸ¿</span></label>
                </div>
            </div>

            <!-- Q9 (å¯è¤‡é¸) -->
            <div class="question-card mod-4" id="card-Q9">
                <div class="q-header"><span class="q-num">09</span><div class="q-title">æŠ•è³‡ç¶“é©—<span class="q-multi-hint">(å¯è¤‡é¸)</span></div></div>
                <div class="options" data-id="Q9">
                    <label class="option-label"><input type="checkbox" value="ç„¡"><div class="box"></div><span class="option-text">å¹¾ä¹æ²’æœ‰ç¶“é©—</span></label>
                    <label class="option-label"><input type="checkbox" value="å®šå­˜"><div class="box"></div><span class="option-text">å®šå­˜ / å„²è“„éšª</span></label>
                    <label class="option-label"><input type="checkbox" value="é•·æœŸ"><div class="box"></div><span class="option-text">é•·æœŸæŒæœ‰ åŸºé‡‘/ETF</span></label>
                    <label class="option-label"><input type="checkbox" value="æ³¢å‹•"><div class="box"></div><span class="option-text">å€‹è‚¡ / æœŸè²¨ / æ³¢å‹•</span></label>
                </div>
            </div>

            <!-- Q10 -->
            <div class="question-card mod-4" id="card-Q10">
                <div class="q-header"><span class="q-num">10</span><div class="q-title">ä¸‹è·Œè¡Œç‚º</div></div>
                <div class="options" data-id="Q10">
                    <label class="option-label"><input type="checkbox" value="åœæ" data-score="feeling:2"><div class="box"></div><span class="option-text">åœææˆ–å‡ºæ¸…</span></label>
                    <label class="option-label"><input type="checkbox" value="è§€æœ›" data-score="feeling:1"><div class="box"></div><span class="option-text">è§€æœ›ï¼Œä¸å¤ªæ•¢å‹•</span></label>
                    <label class="option-label"><input type="checkbox" value="åŠ ç¢¼" data-score="logic:1"><div class="box"></div><span class="option-text">åˆ†æ‰¹åŠ ç¢¼ (æ”¤å¹³)</span></label>
                    <label class="option-label"><input type="checkbox" value="ç…§è¨ˆç•«" data-score="logic:2"><div class="box"></div><span class="option-text">å¹¾ä¹ä¸çœ‹ï¼Œç…§è¨ˆç•«åŸ·è¡Œ</span></label>
                </div>
            </div>

            <!-- Q11 (å¯è¤‡é¸) -->
            <div class="question-card mod-pain full-width" id="card-Q11">
                <div class="q-header"><span class="q-num">11</span><div class="q-title">ç¾éšæ®µæœ€å¤§æ“”æ†‚<span class="q-multi-hint">(å¯è¤‡é¸)</span></div></div>
                <div class="options" data-id="Q11">
                    <label class="option-label"><input type="checkbox" value="é€šè†¨" data-score="growth:1"><div class="box"></div><span class="option-text">éŒ¢è¢«é€šè†¨åƒæ‰</span></label>
                    <label class="option-label"><input type="checkbox" value="æ„å¤–" data-score="defend:1;driver:A"><div class="box"></div><span class="option-text">ç™¼ç”Ÿæ„å¤–/ç”Ÿç—…ï¼Œå­˜æ¬¾æ­¸é›¶</span></label>
                    <label class="option-label"><input type="checkbox" value="ç¡ä¸è‘—" data-score="defend:1;driver:A"><div class="box"></div><span class="option-text">æŠ•è³‡å¤§èµ·å¤§è½ï¼Œæ™šä¸Šç¡ä¸è‘—</span></label>
                    <label class="option-label"><input type="checkbox" value="é€€ä¼‘" data-score="long:1;driver:G"><div class="box"></div><span class="option-text">é€€ä¼‘é‡‘å¤ªæ…¢ï¼Œæ€•ä¸å¤ ç”¨</span></label>
                </div>
            </div>
        </div>

        <div class="actions">
            <button type="button" class="btn" onclick="analyzeAndGen()">æŸ¥çœ‹æˆ‘çš„è²¡å‹™äººæ ¼</button>
        </div>
    </form>
</div>

<!-- å³æ™‚åˆ†æçµæœé  -->
<div id="analysis-overlay">
    <div class="analysis-card">
        <div class="persona-header" id="persona-bg">
            <div class="persona-img-container">
                <!-- é€™è£¡å¦‚æœæ²’æœ‰åœ–ç‰‡ï¼Œæœƒé¡¯ç¤º Emoji -->
                <img id="persona-img" src="" class="persona-img" onerror="this.style.display='none'; document.getElementById('persona-icon').style.display='block';">
                <div id="persona-icon" class="persona-emoji"></div>
            </div>
            <div class="persona-subtitle">æ‚¨çš„è²¡å‹™ DNA</div>
            <div class="persona-title" id="persona-title">åˆ†æä¸­...</div>
            <div class="persona-code" id="persona-code"></div>
        </div>
        
        <div class="persona-body">
            <!-- 4 ç¶­åº¦åœ– -->
            <div class="dim-container">
                <div class="trait-row"><span class="trait-label">é˜²ç¦¦</span><div class="trait-bar-bg"><div class="trait-bar-fill bar-left color-safe" id="bar-defend"></div><div class="trait-bar-fill bar-right color-growth" id="bar-growth"></div></div><span class="trait-label">æˆé•·</span></div>
                <div class="trait-row"><span class="trait-label">æ„Ÿæ€§</span><div class="trait-bar-bg"><div class="trait-bar-fill bar-left color-safe" id="bar-feeling"></div><div class="trait-bar-fill bar-right color-growth" id="bar-logic"></div></div><span class="trait-label">ç†æ€§</span></div>
                <div class="trait-row"><span class="trait-label">çŸ­æœŸ</span><div class="trait-bar-bg"><div class="trait-bar-fill bar-left color-safe" id="bar-short"></div><div class="trait-bar-fill bar-right color-growth" id="bar-long"></div></div><span class="trait-label">é•·æœŸ</span></div>
                <div class="trait-row"><span class="trait-label">ä¾è³´</span><div class="trait-bar-bg"><div class="trait-bar-fill bar-left color-safe" id="bar-depend"></div><div class="trait-bar-fill bar-right color-growth" id="bar-indep"></div></div><span class="trait-label">ç¨ç«‹</span></div>
            </div>

            <div class="analysis-text" id="analysis-text"></div>

            <div class="cta-box">
                <p class="cta-text">é»æˆ‘ç”¢ç”Ÿ <span class="cta-highlight">å•å·æˆªåœ–</span> çµ¦é¡§å•<br><span style="font-weight:400; font-size:14px; color:#666;">å³å¯å–å¾—å®Œæ•´åˆ†æçµæœ</span></p>
                <button class="next-step-btn" onclick="genCapture()">ğŸ“¸ ç”¢ç”Ÿå®Œæ•´åˆ†ææˆªåœ–</button>
            </div>
            
            <div style="text-align:center; margin-top:15px;">
                <button onclick="document.getElementById('analysis-overlay').style.display='none'" style="background:transparent; border:none; color:#999; text-decoration:underline;">è¿”å›ä¿®æ”¹</button>
            </div>
        </div>
    </div>
</div>

<!-- éš±è—æˆªåœ–å€ (é€™å°±æ˜¯ç”Ÿæˆåœ–ç‰‡çš„æ¨¡æ¿) -->
<div id="capture-area">
    <div class="cap-header">
        <h1 style="color:#006e7f; margin:0; font-size:32px;">è²¡å‹™å¥æª¢è¨ºæ–·è¡¨</h1>
        <p style="color:#666; font-size:16px;">å°ˆå±¬æŠ•è³‡è™•æ–¹ç±¤</p>
    </div>
    
    <div class="cap-info">
        <div><strong>å§“åï¼š</strong><span id="cap-name"></span></div>
        <div><strong>é›»è©±ï¼š</strong><span id="cap-phone"></span></div>
        <div><strong>Lineï¼š</strong><span id="cap-line"></span></div>
        <div style="margin-top:10px; border-top:1px dashed #ccc; padding-top:10px;">
            <span style="font-size:12px; color:#666;">è²¡å‹™äººæ ¼ä»£ç¢¼ï¼š</span>
            <span id="cap-code" style="font-weight:700; color:#006e7f; font-size:18px;"></span>
        </div>
    </div>

    <div id="cap-content">
        <!-- ç­”æ¡ˆæœƒå¡åœ¨é€™è£¡ -->
    </div>

    <div style="margin-top:30px; text-align:center; padding-top:20px; border-top:1px solid #eee;">
        <p style="color:#006e7f; font-weight:700;">â–² è«‹å°‡æ­¤åœ–å‚³é€çµ¦æ‚¨çš„é¡§å•é€²è¡Œåˆ†æ â–²</p>
    </div>
</div>

<!-- çµæœé¡¯ç¤º Modal -->
<div id="result-overlay">
    <div id="final-image-container">
        <p style="color:white; font-weight:700; margin-bottom:10px; font-size:18px;">ğŸ‘‡ é•·æŒ‰åœ–ç‰‡å„²å­˜ï¼Œå†å‚³çµ¦æˆ‘ ğŸ‘‡</p>
        <img id="generated-image" src="" alt="çµæœåœ–">
        <button class="close-btn" onclick="document.getElementById('result-overlay').style.display='none'">é—œé–‰</button>
    </div>
</div>

<script>
    // é»é¸é‚è¼¯
    document.querySelectorAll('.option-label').forEach(l => {
        l.addEventListener('click', function(e) {
            if (e.target.tagName === 'INPUT' && e.target.type === 'text') return;
            setTimeout(() => {
                const chk = this.querySelector('input[type="checkbox"]');
                if(chk.checked) this.classList.add('selected');
                else this.classList.remove('selected');
                // å–æ¶ˆç´…æ¡†
                const card = this.closest('.question-card');
                if(card.style.borderColor === 'rgb(225, 29, 72)') { // Red color
                    card.style.borderColor = '#e2e8f0';
                    card.style.boxShadow = '0 2px 5px rgba(0,0,0,0.02)';
                }
            }, 10);
        });
    });

    const otherInput = document.getElementById('q5-other-input');
    const otherCheck = document.getElementById('q5-other-check');
    otherInput.addEventListener('click', function(e) { e.stopPropagation(); });
    otherInput.addEventListener('input', function() {
        if (this.value.length > 0) {
            otherCheck.checked = true;
            this.closest('.option-label').classList.add('selected');
        }
    });

    // 16å‹äººæ ¼è³‡æ–™åº« (16 Persona Database)
    const PERSONA_DB = {
        'GLVI': { title: 'æˆ°ç•¥ç¸½æŒ‡æ®', icon: 'ğŸ¦', desc: 'æ‚¨æ“æœ‰æ¥µä½³çš„æˆ°ç•¥çœ¼å…‰èˆ‡ç†æ€§ï¼Œä¸”ç¿’æ…£ç¨ç«‹æ±ºç­–ã€‚é©åˆæ§‹å»ºå®å¤§çš„è³‡ç”¢ç‰ˆåœ–ã€‚' },
        'GLVR': { title: 'ç©©å¥å»ºç¯‰å¸«', icon: 'ğŸ›ï¸', desc: 'æ‚¨é‡è¦–çµæ§‹èˆ‡é•·é è¦åŠƒï¼Œä½†å‚¾å‘å°‹æ±‚å°ˆæ¥­æ„è¦‹ä¾†éå›ºåœ°åŸºã€‚' },
        'GLNI': { title: 'çŸ­ç·šçµæ‰‹', icon: 'ğŸ†', desc: 'æ‚¨ç†æ€§ä¸”åæ‡‰å¿«ï¼Œå–œæ­¡æŒæ¡çŸ­æœŸæ©Ÿæœƒï¼Œæ“ä½œéˆæ´»ã€‚' },
        'GLNR': { title: 'è¶¨å‹¢è·Ÿéš¨è€…', icon: 'ğŸ„', desc: 'æ‚¨ç†æ€§åˆ†æç•¶ä¸‹å±€å‹¢ï¼Œä¸¦å–„æ–¼è·Ÿéš¨å¸‚å ´è¶¨å‹¢ç²åˆ©ã€‚' },
        'GEVI': { title: 'å¤¢æƒ³èˆªæµ·å®¶', icon: 'â›µ', desc: 'æ‚¨æ†‘ç›´è¦ºçœ‹è¦‹é æ–¹ï¼Œä¸¦å‹‡æ•¢ç¨ç«‹å•Ÿèˆªï¼Œè¿½æ±‚å¿ƒä¸­çš„è²¡å¯Œè‡ªç”±ã€‚' },
        'GEVR': { title: 'ç¤¾ç¾¤é ˜è¢–', icon: 'ğŸŒ»', desc: 'æ‚¨é‡è¦–é•·æœŸåƒ¹å€¼èˆ‡äººéš›é€£çµï¼ŒæŠ•è³‡æ±ºç­–å¸¸å¸¶æœ‰æº«æš–çš„é¡˜æ™¯ã€‚' },
        'GENI': { title: 'ç›´è¦ºè—è¡“å®¶', icon: 'ğŸ¨', desc: 'æ‚¨æ†‘æ„Ÿè¦ºæ•æ‰ç•¶ä¸‹çš„æ©Ÿæœƒï¼ŒæŠ•è³‡é¢¨æ ¼ç¨ç‰¹ä¸”éš¨æ€§ã€‚' },
        'GENR': { title: 'å¿«æ¨‚é«”é©—è€…', icon: 'ğŸ¥³', desc: 'æ‚¨é‡è¦–ç•¶ä¸‹çš„å¿«æ¨‚èˆ‡é«”é©—ï¼Œç†è²¡æ˜¯ç‚ºäº†è®“ç”Ÿæ´»æ›´è±å¯Œã€‚' },
        'PLVI': { title: 'å®ˆæœ›ç‡ˆå¡”', icon: 'ğŸ¯', desc: 'æ‚¨ç¨ç«‹ä¸”ç†æ€§ï¼Œæ³¨é‡é•·æœŸçš„é˜²ç¦¦èˆ‡è³‡ç”¢ä¿å…¨ï¼Œä¸éš¨æ³¢é€æµã€‚' },
        'PLVR': { title: 'ä¿¡è¨—å®ˆè­·è€…', icon: 'ğŸ›¡ï¸', desc: 'æ‚¨ç›¸ä¿¡åˆ¶åº¦èˆ‡å°ˆæ¥­ï¼Œå‚¾å‘å°‡è³‡ç”¢äº¤ç”±ç©©å¥çš„ç³»çµ±ä¾†é•·æœŸå®ˆè­·ã€‚' },
        'PLNI': { title: 'ç²¾ç®—æœƒè¨ˆå¸«', icon: 'ğŸ§®', desc: 'æ‚¨ç²¾æ‰“ç´°ç®—ï¼Œé‡è¦–æ¯ä¸€åˆ†éŒ¢çš„ç•¶ä¸‹æ•ˆç›Šï¼Œçµ•ä¸æµªè²»ã€‚' },
        'PLNR': { title: 'è¬¹æ…å­˜éŒ¢ç­’', icon: 'ğŸ–', desc: 'æ‚¨ç›¸ä¿¡ç¾é‡‘ç‚ºç‹ï¼Œå‚¾å‘ä¿å®ˆå„²è“„ï¼Œå°‹æ±‚æœ€ç°¡å–®çš„å®‰å…¨æ„Ÿã€‚' },
        'PEVI': { title: 'ç”Ÿæ…‹ä¿è‚²å®¶', icon: 'ğŸŒ³', desc: 'æ‚¨ç”¨ç›´è¦ºå®ˆè­·é•·é çš„è³‡ç”¢ï¼Œåƒç¨®æ¨¹ä¸€æ¨£è€å¿ƒç­‰å¾…æˆè”­ã€‚' },
        'PEVR': { title: 'å®‰å¿ƒä¾è³´è€…', icon: 'ğŸ¡', desc: 'æ‚¨æœ€é‡è¦–å®¶åº­èˆ‡å®‰å…¨æ„Ÿï¼Œéœ€è¦ä¸€å€‹å€¼å¾—ä¿¡è³´çš„ä¾é ä¾†è¦åŠƒæœªä¾†ã€‚' },
        'PENI': { title: 'ç›´è¦ºé¿éšªå®¶', icon: 'ğŸ¦”', desc: 'æ‚¨å°é¢¨éšªæ¥µåº¦æ•æ„Ÿï¼Œæ†‘ç›´è¦ºé¿é–‹å±éšªï¼Œè‡ªæˆ‘ä¿è­·æ„è­˜å¼·ã€‚' },
        'PENR': { title: 'å®‰ç©©éš¨è¡Œè€…', icon: 'ğŸ‚', desc: 'æ‚¨éš¨é‡è€Œå®‰ï¼Œä¸å¼·æ±‚å¯Œè²´ï¼Œåªæ±‚ç”Ÿæ´»å¹³ç©©ç„¡æ†‚ã€‚' }
    };

    function analyzeAndGen() {
        // å¿…å¡«é˜²å‘†
        const name = document.getElementById('name').value;
        if(!name) { alert('è«‹å¡«å¯«å§“åå–”ï¼'); document.getElementById('name').focus(); return; }

        let isValid = true;
        const qids = ['Q1','Q2','Q3','Q4','Q5','Q6','Q7','Q8','Q9','Q10','Q11'];
        for(let id of qids) {
            const checked = document.querySelectorAll(`.options[data-id="${id}"] input:checked`);
            if(checked.length === 0) {
                const card = document.getElementById('card-' + id);
                card.style.borderColor = '#e11d48';
                card.style.boxShadow = '0 0 10px rgba(225, 29, 72, 0.2)';
                card.scrollIntoView({behavior: 'smooth', block: 'center'});
                isValid = false;
                break; 
            }
        }
        if(!isValid) { alert('è«‹å›ç­”æ¯ä¸€é¡Œå–”ï¼'); return; }


        let scores = { defend: 0, growth: 0, feeling: 0, logic: 0, short: 0, long: 0, depend: 0, indep: 0, driver: { A:0, G:0, F:0, O:0 } };

        document.querySelectorAll('input:checked').forEach(input => {
            const attr = input.getAttribute('data-score');
            if(attr) {
                const pairs = attr.split(';');
                pairs.forEach(pair => {
                    const [key, val] = pair.split(':');
                    if(key === 'driver') scores.driver[val]++;
                    else if(scores[key] !== undefined) scores[key] += parseInt(val);
                });
            }
        });

        function calcPct(a, b) {
            if(a+b === 0) return 50;
            return (a / (a+b)) * 100;
        }

        // Bar Animation
        document.getElementById('bar-defend').style.width = calcPct(scores.defend, scores.growth) + '%';
        document.getElementById('bar-growth').style.width = calcPct(scores.growth, scores.defend) + '%';
        document.getElementById('bar-feeling').style.width = calcPct(scores.feeling, scores.logic) + '%';
        document.getElementById('bar-logic').style.width = calcPct(scores.logic, scores.feeling) + '%';
        document.getElementById('bar-short').style.width = calcPct(scores.short, scores.long) + '%';
        document.getElementById('bar-long').style.width = calcPct(scores.long, scores.short) + '%';
        document.getElementById('bar-depend').style.width = calcPct(scores.depend, scores.indep) + '%';
        document.getElementById('bar-indep').style.width = calcPct(scores.indep, scores.depend) + '%';

        // 4+1 Code
        let codeKey = "";
        codeKey += (scores.growth >= scores.defend) ? "G" : "P";
        codeKey += (scores.logic >= scores.feeling) ? "L" : "E";
        codeKey += (scores.long >= scores.short) ? "V" : "N";
        codeKey += (scores.indep >= scores.depend) ? "I" : "R";

        let displayCode = "[ " + codeKey;
        let maxDriver = '';
        let maxVal = -1;
        for (const [key, val] of Object.entries(scores.driver)) {
            if (val > maxVal) { maxVal = val; maxDriver = key; }
        }
        if (maxVal > 0) displayCode += "-" + maxDriver;
        displayCode += " ]";

        const personaData = PERSONA_DB[codeKey] || { title: 'ç¥ç§˜æ¢ç´¢è€…', icon: 'â“', desc: 'æ‚¨çš„å±¬æ€§ç¨ç‰¹ï¼Œè«‹æˆªåœ–è«®è©¢é¡§å•ã€‚' };

        document.getElementById('persona-title').innerText = personaData.title;
        document.getElementById('persona-code').innerText = displayCode;
        document.getElementById('persona-icon').innerText = personaData.icon;
        // å¦‚æœæœ‰åœ–æª”: document.getElementById('persona-img').src = "p_" + codeKey.toLowerCase() + ".png"; 
        document.getElementById('analysis-text').innerText = personaData.desc;
        
        const header = document.getElementById('persona-bg');
        if (codeKey.startsWith('G')) {
            header.style.background = 'linear-gradient(135deg, #f59e0b, #ea580c)';
        } else {
            header.style.background = 'linear-gradient(135deg, #006e7f, #0f766e)';
        }

        // å¡«å…¥æˆªåœ–ç”¨éš±è—å€
        document.getElementById('cap-code').innerText = displayCode;
        document.getElementById('cap-persona').innerText = personaData.title;
        
        document.getElementById('analysis-overlay').style.display = 'block';
    }

    // ç”Ÿæˆæˆªåœ–
    function genCapture() {
        const name = document.getElementById('name').value;
        const lineId = document.getElementById('lineId').value;
        const phone = document.getElementById('phone').value;
        
        document.getElementById('cap-name').innerText = name;
        document.getElementById('cap-line').innerText = lineId;
        document.getElementById('cap-phone').innerText = phone;

        const qids = ['Q1','Q2','Q3','Q4','Q5','Q6','Q7','Q8','Q9','Q10','Q11'];
        let html = '';

        qids.forEach((id, idx) => {
            const opts = document.querySelectorAll(`.options[data-id="${id}"] input:checked`);
            let vals = [];
            opts.forEach(o => {
                if (o.value === 'other') {
                    const otherVal = document.getElementById('q5-other-input').value;
                    vals.push('å…¶ä»–ï¼š' + (otherVal || 'æœªå¡«å¯«'));
                } else {
                    vals.push(o.parentNode.querySelector('.option-text').innerText);
                }
            });
            
            if(vals.length > 0) {
                const titleEl = document.querySelector(`.options[data-id="${id}"]`).previousElementSibling.querySelector('.q-title');
                // ç§»é™¤æ¨™é¡Œä¸­çš„ (å¯è¤‡é¸) æç¤ºï¼Œè®“æˆªåœ–æ›´ä¹¾æ·¨
                let title = titleEl.innerText.replace(/\(å¯è¤‡é¸\)/g, '').trim();
                
                html += `<div class="cap-item">
                    <div class="cap-q">Q${idx+1} ${title}</div>
                    <div class="cap-a">${vals.join('ã€')}</div>
                </div>`;
            }
        });
        
        document.getElementById('cap-content').innerHTML = html;

        const btn = document.querySelector('.next-step-btn');
        const originalText = btn.innerText;
        btn.innerText = 'ç”Ÿæˆä¸­...';
        
        html2canvas(document.querySelector("#capture-area"), {scale: 2}).then(canvas => {
            const imgUrl = canvas.toDataURL("image/png");
            document.getElementById('generated-image').src = imgUrl;
            document.getElementById('result-overlay').style.display = 'block';
            btn.innerText = originalText;
        });
    }
</script>

</body>
</html>


